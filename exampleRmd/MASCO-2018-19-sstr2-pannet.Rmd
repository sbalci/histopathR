---
title: "MASCO 2018-2019 SSTR PanNET"
output:
  html_notebook: 
    code_folding: hide
    fig_caption: yes
    number_sections: yes
    toc: yes
    toc_depth: 3
    toc_float: yes
    fig_height: 6
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 3
  pdf_document: 
    fig_caption: yes
    highlight: kate
    number_sections: yes
    toc: yes
    latex_engine: lualatex
---



```{r load library, include=FALSE}
suppressMessages(library(tidyverse))
suppressMessages(library(foreign))
suppressMessages(library(tidylog))
suppressMessages(library(janitor))
suppressMessages(library(report))
suppressMessages(library(formatR))
```



```{r setup global_options chunk settings, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	error = FALSE,
	# fig.height = 8,
	# fig.width = 12,
	message = FALSE,
	warning = FALSE,
	# cache = TRUE,
	comment = NA,
	tidy = TRUE,
	tidy.opts=list(width.cutoff=60)
	# results = "asis"
	# linewidth = 60
)
```




```{r read excel, include=FALSE}
library(readxl)
masco_pannet <- read_excel("masco-2018-19-sstr2-pannet.xls", 
    na = "N/A", skip = 1)

# View(masco_pannet)
```


```{r clean names}
masco_pannet <- masco_pannet %>% 
  janitor::clean_names()
```


---

\pagebreak


# Descriptive Statistics

## Age

```{r yas, eval=FALSE, include=FALSE}
masco_pannet %>% 
  janitor::tabyl(yas) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


```{r yas to numeric}
masco_pannet$yas <- as.numeric(as.character(masco_pannet$yas))
```


```{r Descriptives yas, echo=FALSE, layout="l-body-outset"}
jmv::descriptives(
    data = masco_pannet,
    vars = vars("yas"),
    # splitBy = "DIPCvsOthers",
    mean = TRUE, 
    median = TRUE,
    freq = TRUE,
    hist = TRUE,
    dens = TRUE,
    bar = TRUE,
    box = TRUE,
    violin = TRUE,
    dot = TRUE,
    mode = TRUE,
    sum = TRUE,
    sd = TRUE,
    variance = TRUE,
    range = TRUE,
    se = TRUE,
    skew = TRUE,
    kurt = TRUE,
    quart = TRUE,
    pcEqGr = TRUE)
```


---

\pagebreak


## Gender

```{r cinsiyet, echo=FALSE}

## Recoding masco_pannet$cins into masco_pannet$gender
masco_pannet$gender <- fct_recode(masco_pannet$cins,
               "Kadin" = "K",
               "Erkek" = "E")



masco_pannet %>% 
  janitor::tabyl(gender) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


---

\pagebreak


## Grade



```{r grade}

## Recoding masco_pannet$grade
masco_pannet$grade <- factor(masco_pannet$grade)

## Reordering masco_pannet$grade
masco_pannet$grade <- factor(masco_pannet$grade, levels=c("G1", "G2", "G3-NEK"))


masco_pannet %>% 
  janitor::tabyl(grade) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```

---

## Lezyon sayısı


```{r}
masco_pannet %>% 
  janitor::tabyl(tek_multipl) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```



```{r}
## Recoding masco_pannet$tek_multipl into masco_pannet$LezyonSayisi
masco_pannet$LezyonSayisi <- recode(masco_pannet$tek_multipl,
               "TEK" = "tek",
               "2 ADET" = "multipl",
               ">100 ADET" = "multipl",
               "3 ADET" = "multipl",
               "7 ADET" = "multipl")
masco_pannet$LezyonSayisi <- factor(masco_pannet$LezyonSayisi)

## Reordering masco_pannet$LezyonSayisi
masco_pannet$LezyonSayisi <- factor(masco_pannet$LezyonSayisi, levels=c("tek", "multipl"))

```


```{r}
masco_pannet %>% 
  janitor::tabyl(LezyonSayisi) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


---

\pagebreak


## Tumor Size


```{r cap to numeric}
masco_pannet$cap <- as.numeric(as.character(masco_pannet$cap_cm))
```


```{r Descriptives cap, layout="l-body-outset"}
jmv::descriptives(
    data = masco_pannet,
    vars = vars("cap"),
    # splitBy = "DIPCvsOthers",
    mean = TRUE, 
    median = TRUE,
    freq = TRUE,
    hist = TRUE,
    dens = TRUE,
    bar = TRUE,
    box = TRUE,
    violin = TRUE,
    dot = TRUE,
    mode = TRUE,
    sum = TRUE,
    sd = TRUE,
    variance = TRUE,
    range = TRUE,
    se = TRUE,
    skew = TRUE,
    kurt = TRUE,
    quart = TRUE,
    pcEqGr = TRUE)
```



```{r}

## Recoding masco_pannet$ln_met into masco_pannet$MetastaticLN
masco_pannet$MetastaticLN <- recode(masco_pannet$ln_met,
               "YOK" = "Yok",
               "VAR" = "Var")
masco_pannet$MetastaticLN <- factor(masco_pannet$MetastaticLN)




```


---

\pagebreak


## Metastatic Lymph Nodes

```{r MetastaticLN}
masco_pannet %>% 
  janitor::tabyl(MetastaticLN) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


---

## Ki67


```{r}
masco_pannet$ki67_pb[masco_pannet$ki67_pb == "0-1"] <- "1"
```



```{r Ki67 numeric}
masco_pannet$Ki67 <- as.numeric(as.character(masco_pannet$ki67_pb))

```

```{r Descriptives Ki67, layout="l-body-outset"}
jmv::descriptives(
    data = masco_pannet,
    vars = vars("Ki67"),
    # splitBy = "DIPCvsOthers",
    mean = TRUE, 
    median = TRUE,
    freq = TRUE,
    hist = TRUE,
    dens = TRUE,
    bar = TRUE,
    box = TRUE,
    violin = TRUE,
    dot = TRUE,
    mode = TRUE,
    sum = TRUE,
    sd = TRUE,
    variance = TRUE,
    range = TRUE,
    se = TRUE,
    skew = TRUE,
    kurt = TRUE,
    quart = TRUE,
    pcEqGr = TRUE)
```



```{r make Ki67 groups}
masco_pannet <- masco_pannet %>% 
  mutate(
    Ki67_Group = case_when(
      ki67_pb < 3              ~ "Low",
      ki67_pb >= 3 & ki67_pb <= 20 ~ "Moderate",
      ki67_pb > 20  ~ "High"
    )
  )

## Reordering masco_pannet$Ki67_Group
masco_pannet$Ki67_Group <- factor(masco_pannet$Ki67_Group, levels=c("Low", "Moderate", "High"))


```


```{r Ki67 Group}
masco_pannet %>% 
  janitor::tabyl(Ki67_Group) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```

---

\pagebreak


## Mitosis

```{r make mitosis numeric}
masco_pannet$mitosis <- as.numeric(as.character(masco_pannet$mitoz))

```



```{r Descriptives Mitosis, layout="l-body-outset"}
jmv::descriptives(
    data = masco_pannet,
    vars = vars("mitosis"),
    # splitBy = "DIPCvsOthers",
    mean = TRUE, 
    median = TRUE,
    freq = TRUE,
    hist = TRUE,
    dens = TRUE,
    bar = TRUE,
    box = TRUE,
    violin = TRUE,
    dot = TRUE,
    mode = TRUE,
    sum = TRUE,
    sd = TRUE,
    variance = TRUE,
    range = TRUE,
    se = TRUE,
    skew = TRUE,
    kurt = TRUE,
    quart = TRUE,
    pcEqGr = TRUE)
```




```{r make mitosis groups}
masco_pannet <- masco_pannet %>% 
  mutate(
    Mitosis_Group = case_when(
      mitoz < 2             ~ "Low",
      mitoz >= 2 & mitoz <= 20  ~ "Moderate",
      mitoz > 20 ~ "High"
    )
  )
```


```{r Mitosis Group}
masco_pannet %>% 
  janitor::tabyl(Mitosis_Group) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```

---

\pagebreak


## Surgical Margin

```{r surgical margin recode}
## Recoding masco_pannet$cs into masco_pannet$SurgicalMargin
masco_pannet$SurgicalMargin <- recode(masco_pannet$cs,
               "R0" = "Absent",
               "R1" = "Present")
masco_pannet$SurgicalMargin <- factor(masco_pannet$SurgicalMargin)


```


```{r surgical margin}
masco_pannet %>% 
  janitor::tabyl(SurgicalMargin) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


---

## Lymphovascular Invasion

```{r recode LVI}
## Recoding masco_pannet$lvi into masco_pannet$LVI
masco_pannet$LVI <- recode(masco_pannet$lvi,
               "-" = "Negative",
               "+" = "Positive",
               "negatif" = "Negative")
masco_pannet$LVI <- factor(masco_pannet$LVI)
```



```{r LVI}
masco_pannet %>% 
  janitor::tabyl(LVI) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


---

## Perineural Invasion

```{r recode PNI}
## Recoding masco_pannet$pni into masco_pannet$PNI
masco_pannet$PNI <- recode(masco_pannet$pni,
               "+" = "Positive",
               "-" = "Negative",
               "negatif" = "Negative")
masco_pannet$PNI <- factor(masco_pannet$PNI)
```


```{r PNI}
masco_pannet %>% 
  janitor::tabyl(PNI) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


---

## Status

```{r status}
masco_pannet %>% 
  janitor::tabyl(status) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```



```{r recode status}
## Recoding masco_pannet$status into masco_pannet$Outcome
masco_pannet$Outcome <- recode(masco_pannet$status,
               "alive" = "0",
               "deceased" = "1",
               "unknown/foreign" = NA_character_)
masco_pannet$Outcome <- as.numeric(masco_pannet$Outcome)

```


---

## Survival Time

```{r recode time}
masco_pannet$time <- as.numeric(as.character(masco_pannet$time_lived_months))
```


---

## SSTR

```{r recode sstr yogunluk}
## Recoding masco_pannet$yogunluk into masco_pannet$yogun
masco_pannet$yogun <- recode(masco_pannet$yogunluk,
               "NEGATİF" = "0",
               "1" = "1",
               "2" = "2",
               "3" = "3"
               )
masco_pannet$yogun <- factor(masco_pannet$yogun)

## Reordering masco_pannet$yogun
masco_pannet$yogun <- factor(masco_pannet$yogun, levels=c("0", "1", "2", "3"))

```


```{r recode sstr yogunluk low high}
## Recoding masco_pannet$yogunluk into masco_pannet$yogunLH
masco_pannet$yogunLH <- recode(masco_pannet$yogunluk,
               "NEGATİF" = "low",
               "1" = "low",
               "2" = "high",
               "3" = "high"
               )
masco_pannet$yogunLH <- factor(masco_pannet$yogunLH)

## Reordering masco_pannet$yogunLH
masco_pannet$yogunLH <- factor(masco_pannet$yogunLH, levels=c("low", "high"))

```





```{r SSTR yogun}
masco_pannet %>% 
  janitor::tabyl(yogun) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


```{r SSTR yogun low high}
masco_pannet %>% 
  janitor::tabyl(yogunLH) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```








```{r recode sstr yayginlik}
## Recoding masco_pannet$yayginlik into masco_pannet$yaygin
masco_pannet$yaygin <- recode(masco_pannet$yayginlik,
               "NEGATİF" = "0",
               "1" = "1",
               "2" = "2",
               "3" = "3"
               )
masco_pannet$yaygin <- factor(masco_pannet$yaygin)

## Reordering masco_pannet$yaygin
masco_pannet$yaygin <- factor(masco_pannet$yaygin, levels=c("0", "1", "2", "3"))

```


```{r recode sstr yayginlik low high}
## Recoding masco_pannet$yayginlik into masco_pannet$yayginLH
masco_pannet$yayginLH <- recode(masco_pannet$yayginlik,
               "NEGATİF" = "low",
               "1" = "low",
               "2" = "high",
               "3" = "high"
               )
masco_pannet$yayginLH <- factor(masco_pannet$yayginLH)

## Reordering masco_pannet$yayginLH
masco_pannet$yayginLH <- factor(masco_pannet$yayginLH, levels=c("low", "high"))

```



```{r SSTR yaygin}
masco_pannet %>% 
  janitor::tabyl(yaygin) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


```{r SSTR yayginLH}
masco_pannet %>% 
  janitor::tabyl(yayginLH) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```



```{r recode sstr pozitif negatif}
## Recoding masco_pannet$yayginlik into masco_pannet$SSTR
masco_pannet$SSTR <- recode(masco_pannet$yayginlik,
               "NEGATİF" = "negative",
               "1" = "positive",
               "2" = "positive",
               "3" = "positive"
               )
masco_pannet$SSTR <- factor(masco_pannet$SSTR)

## Reordering masco_pannet$SSTR
masco_pannet$SSTR <- factor(masco_pannet$SSTR, levels=c("negative", "positive"))

```



```{r SSTR pozitif negatif}
masco_pannet %>% 
  janitor::tabyl(SSTR) %>%
  adorn_pct_formatting(rounding = 'half up', digits = 1) %>%
  knitr::kable()
```


---

\pagebreak


# Cross Tables

```{r}
library(finalfit)
```

---

## SSTR yaygınlık

```{r}
dependentSSTR1 <- "yaygin"
explanatorySSTR1 <- c("yas", "gender", "grade", "cap", "MetastaticLN", "Ki67", "Ki67_Group", "mitosis", "Mitosis_Group", "SurgicalMargin", "LVI", "PNI")
```


```{r crosstable SSTR yaygin}

masco_pannet %>%
  summary_factorlist(dependentSSTR1, explanatorySSTR1,
  p = TRUE, add_dependent_label = TRUE) -> tSSTR1

knitr::kable(tSSTR1, row.names = FALSE, align = c("l", "l", "r", "r", "r"))
```


---

\pagebreak



## SSTR yaygınlık düşük yüksek


```{r}
dependentSSTRLH <- "yayginLH"
explanatorySSTRLH <- c("yas", "gender", "grade", "cap", "MetastaticLN", "Ki67", "Ki67_Group", "mitosis", "Mitosis_Group", "SurgicalMargin", "LVI", "PNI")
```


```{r crosstable SSTR yaygin LH}

masco_pannet %>%
  summary_factorlist(dependentSSTRLH, explanatorySSTRLH,
  p = TRUE, add_dependent_label = TRUE) -> tSSTRLH

knitr::kable(tSSTRLH, row.names = FALSE, align = c("l", "l", "r", "r", "r"))
```


---

\pagebreak


## SSTR yogunluk

```{r}
dependentSSTR2 <- "yogun"
explanatorySSTR2 <- c("yas", "gender", "grade", "cap", "MetastaticLN", "Ki67", "Ki67_Group", "mitosis", "Mitosis_Group", "SurgicalMargin", "LVI", "PNI")
```


```{r crosstable SSTR2}

masco_pannet %>%
  summary_factorlist(dependentSSTR2, explanatorySSTR2,
  p = TRUE, add_dependent_label = TRUE) -> tSSTR2

knitr::kable(tSSTR2, row.names = FALSE, align = c("l", "l", "r", "r", "r"))
```


---

\pagebreak


## SSTR yogunluk düşük yüksek

```{r}
dependentSSTR2LH <- "yogunLH"
explanatorySSTR2LH <- c("yas", "gender", "grade", "cap", "MetastaticLN", "Ki67", "Ki67_Group", "mitosis", "Mitosis_Group", "SurgicalMargin", "LVI", "PNI")
```


```{r crosstable SSTR2 low high}
masco_pannet %>%
  summary_factorlist(dependentSSTR2LH, explanatorySSTR2LH,
  p = TRUE, add_dependent_label = TRUE) -> tSSTR2LH

knitr::kable(tSSTR2LH, row.names = FALSE, align = c("l", "l", "r", "r", "r"))
```


---

\pagebreak


## SSTR pozitif negatif

```{r}
dependentSSTRPN <- "SSTR"
explanatorySSTRPN <- c("yas", "gender", "grade", "cap", "MetastaticLN", "Ki67", "Ki67_Group", "mitosis", "Mitosis_Group", "SurgicalMargin", "LVI", "PNI")
```


```{r crosstable SSTR positive negative}

masco_pannet %>%
  summary_factorlist(dependentSSTRPN, explanatorySSTRPN,
  p = TRUE, add_dependent_label = TRUE) -> tSSTRPN

knitr::kable(tSSTRPN, row.names = FALSE, align = c("l", "l", "r", "r", "r"))
```

---

\pagebreak



```{r ggstatplot yas, error=FALSE, warning=FALSE}
library(ggstatsplot)
masco_pannet %>% 
    ggstatsplot::ggbetweenstats(SSTR, yas, plot.type = "boxviolin")
```


---

\pagebreak


```{r ggstatplot gender}
masco_pannet %>% 
    ggstatsplot::ggbarstats(SSTR, gender)
```

---

\pagebreak



```{r ggstatplot grade}
masco_pannet %>% 
    ggstatsplot::ggbarstats(SSTR, grade)
```

---

\pagebreak


```{r ggstatplot cap}
masco_pannet %>% 
    ggstatsplot::ggbetweenstats(SSTR, cap, plot.type = "boxviolin")
```


---

\pagebreak


```{r ggstatplot metastaticLN}
masco_pannet %>% 
    ggstatsplot::ggbarstats(SSTR, MetastaticLN)
```


---

\pagebreak


```{r ggstatplot Ki67}
masco_pannet %>% 
    ggstatsplot::ggbetweenstats(SSTR, Ki67, plot.type = "boxviolin")
```


---

\pagebreak



```{r ggstatplot Ki67gr}
masco_pannet %>% 
    ggstatsplot::ggbarstats(SSTR, Ki67_Group)
```


---


\pagebreak





```{r ggstatplot mitoz}
masco_pannet %>% 
    ggstatsplot::ggbetweenstats(SSTR, mitosis, plot.type = "boxviolin")
```


---

\pagebreak



```{r ggstatplot Mitosis_Group}
masco_pannet %>% 
    ggstatsplot::ggbarstats(SSTR, Mitosis_Group)
```


---


\pagebreak



```{r ggstatplot SurgicalMargin}
masco_pannet %>% 
    ggstatsplot::ggbarstats(SSTR, SurgicalMargin)
```


---

\pagebreak




```{r ggstatplot LVI}
masco_pannet %>% 
    ggstatsplot::ggbarstats(SSTR, LVI)
```


---

\pagebreak



```{r ggstatplot PNI}
masco_pannet %>% 
    ggstatsplot::ggbarstats(SSTR, PNI)
```


---

\pagebreak


# Correlation Analysis


```{r}
# https://neuropsychology.github.io/psycho.R/2018/05/20/correlation.html
masco_pannet$yogunluk2 <- as.numeric(as.character(masco_pannet$yogun))
masco_pannet$yayginlik2 <- as.numeric(as.character(masco_pannet$yaygin))
```



```{r}
library(ggplot2)
gg <- ggplot(masco_pannet, 
             aes(x = yogunluk2, y = yayginlik2)
             ) + 
    geom_point() +
    geom_count() +
    geom_smooth(method="lm", se = TRUE) 
plot(gg)
```


---

\pagebreak



```{r}
library(ggplot2)
gg <- ggplot(masco_pannet, 
             aes(x = mitosis, y = Ki67)
             ) + 
    geom_point() +
    geom_count() +
    geom_smooth(method="lm", se = TRUE) 
plot(gg)
```



---

\pagebreak



```{r}
suppressPackageStartupMessages(library(psycho))

cor <- masco_pannet %>% 
    select(yas, mitosis, Ki67, yogunluk2, yayginlik2) %>% 
  psycho::correlation(
            # method = "pearson"
            method = "spearman"
            # method = "kendall"
              )
```


```{r eval=FALSE, include=FALSE}
cor %>% 
    report::to_values()
```

---

```{r}
summary(cor)
```

---

```{r}
plot(cor)
```

---

```{r, results='asis'}
print(cor)
```

---

\pagebreak

# Survival Analysis

```{r}
library(survival)
# km <- with(masco_pannet, Surv(time, Outcome))
# head(km,80)
# plot(km)
```

---

## SSTR yogunluk

```{r Kaplan-Meier SSTR yogun}
explanatoryKM_SSTR_yogun <-  c("yogun")
dependentKM_SSTR_yogun <-  "Surv(time, Outcome)"
masco_pannet %>%
  finalfit::surv_plot(dependentKM_SSTR_yogun, explanatoryKM_SSTR_yogun, 
  xlab="Time (months)", pval=TRUE, legend = "none")
```



```{r}
km_fit_SSTR_yogun <- survfit(Surv(time, Outcome) ~ yogun, data = masco_pannet)
km_fit_SSTR_yogun
```


```{r 1-3-5-yr survival SSTR yogunluk}
summary(km_fit_SSTR_yogun, times = c(12,36,60))
```


---

\pagebreak


## SSTR yogunluk düşük yüksek

```{r Kaplan-Meier SSTR yogunLH}
explanatoryKM_SSTR_yogunLH <-  c("yogunLH")
dependentKM_SSTR_yogunLH <-  "Surv(time, Outcome)"
masco_pannet %>%
  finalfit::surv_plot(dependentKM_SSTR_yogunLH, explanatoryKM_SSTR_yogunLH, 
  xlab="Time (months)", pval=TRUE, legend = "none")
```



```{r}
km_fit_SSTR_yogunLH <- survfit(Surv(time, Outcome) ~ yogunLH, data = masco_pannet)
km_fit_SSTR_yogunLH
```


```{r 1-3-5-yr survival SSTR yogunlukLH}
summary(km_fit_SSTR_yogunLH, times = c(12,36,60))
```


---

\pagebreak



## SSTR yayginlik

```{r Kaplan-Meier SSTR yayginlik}
explanatoryKM_SSTR_yaygin <-  c("yaygin")
dependentKM_SSTR_yaygin <-  "Surv(time, Outcome)"
masco_pannet %>%
  surv_plot(dependentKM_SSTR_yaygin, explanatoryKM_SSTR_yaygin, 
  xlab="Time (months)", pval=TRUE, legend = "none")
```



```{r}
km_fit_SSTR_yaygin <- survfit(Surv(time, Outcome) ~ yaygin, data = masco_pannet)
km_fit_SSTR_yaygin
```


```{r 1-3-5-yr survival SSTR}
summary(km_fit_SSTR_yaygin, times = c(12,36,60))
```

---

\pagebreak


## SSTR yayginlik düşük yüksek

```{r Kaplan-Meier SSTR yayginlikLH}
explanatoryKM_SSTR_yayginLH <-  c("yayginLH")
dependentKM_SSTR_yayginLH <-  "Surv(time, Outcome)"
masco_pannet %>%
  finalfit::surv_plot(dependentKM_SSTR_yayginLH, explanatoryKM_SSTR_yayginLH, 
  xlab="Time (months)", pval=TRUE, legend = "none")
```



```{r}
km_fit_SSTR_yayginLH <- survfit(Surv(time, Outcome) ~ yayginLH, data = masco_pannet)
km_fit_SSTR_yayginLH
```


```{r 1-3-5-yr survival SSTRLH}
summary(km_fit_SSTR_yayginLH, times = c(12,36,60))
```


---

\pagebreak


## SSTR positive negative

```{r Kaplan-Meier SSTR positive negative}
explanatoryKM_SSTRPN <-  c("SSTR")
dependentKM_SSTRPN <-  "Surv(time, Outcome)"
masco_pannet %>%
  finalfit::surv_plot(dependentKM_SSTRPN, explanatoryKM_SSTRPN, 
  xlab="Time (months)", pval=TRUE, legend = "none")
```



```{r}
km_fit_SSTRPN <- survfit(Surv(time, Outcome) ~ SSTR, data = masco_pannet)
km_fit_SSTRPN
```


```{r 1-3-5-yr survival SSTR positive negative}
summary(km_fit_SSTRPN, times = c(12,36,60))
```



---

<!-- # broom -->


<!-- ```{r} -->
<!-- # install.packages("tidymodels") -->
<!-- suppressPackageStartupMessages(library(tidymodels)) -->
<!-- ``` -->


<!-- ```{r} -->
<!-- modeloutput <- summary(km_fit_SSTR_yaygin) -->

<!-- # broom::glance(km_fit_SSTR_yaygin) -->

<!-- # broom::glance(km_fit_SSTR_yaygin) %>%  -->
<!-- #     filter(time == "12") -->


<!-- unclass(summary(km_fit_SSTR_yaygin))$table[,"median"][1] -->

<!-- ``` -->

---

\pagebreak


# Multivariate Analysis

<!-- ## Multivariate Analysis 1 -->

<!-- ```{r Multivariate Analysis 1} -->
<!-- library(finalfit) -->
<!-- library(survival) -->
<!-- explanatoryMultivariate <- c("yas", "gender", "grade", "cap", "MetastaticLN", "Ki67", "Ki67_Group", "mitosis", "Mitosis_Group", "SurgicalMargin", "LVI", "PNI", "yogun", "yaygin") -->
<!-- dependentMultivariate = "Surv(time, Outcome)" -->

<!-- masco_pannet %>% -->
<!--   finalfit(dependentMultivariate, explanatoryMultivariate) -> tMultivariate -->

<!-- knitr::kable(tMultivariate, row.names=FALSE, align=c("l", "l", "r", "r", "r", "r")) -->
<!-- ``` -->


**Multivariate Analysis**


**Çok değişkenli analizleri raporlamada kullanmayın. Sadece görmeniz için ekledim.**  
**p değeri ne olursa olsun güven aralıklarında bu kadar büyük fark olması -ki içinde sonsuz bile var- modelin anlamlı olmadığını gösteriyor.**  
**Model neden anlamsız? Çünkü bağımlı değişken olarak sağkalımı alıyoruz. Ölen hasta sayısı birkaç adet. Sağkalım analizi yapabilmek için hastaların en azından yarısının ölmesi, ve bu şekilde `median` sağkalımın hesaplanabilir olması gerekiyor.**


---

```{r Multivariate Analysis}
library(finalfit)
library(survival)
explanatoryMultivariate2 <- c("yas", "gender", "cap", "MetastaticLN", "SurgicalMargin", "LVI", "PNI", "yogun", "yaygin")
dependentMultivariate2 <-  "Surv(time, Outcome)"

masco_pannet %>%
  finalfit(dependentMultivariate2, explanatoryMultivariate2) -> tMultivariate2

knitr::kable(tMultivariate2, row.names=FALSE, align=c("l", "l", "r", "r", "r", "r"))
```


---

\pagebreak



```{r Multivariate AnalysisLH}
library(finalfit)
library(survival)
explanatoryMultivariate3 <- c("yas", "gender", "cap", "MetastaticLN", "SurgicalMargin", "LVI", "PNI", "yogunLH", "yayginLH")
dependentMultivariate3 <-  "Surv(time, Outcome)"

masco_pannet %>%
  finalfit::finalfit(dependentMultivariate3, explanatoryMultivariate3) -> tMultivariate3

knitr::kable(tMultivariate3, row.names=FALSE, align=c("l", "l", "r", "r", "r", "r"))
```


---

\pagebreak



```{r Multivariate Analysis positive negative}
library(finalfit)
library(survival)
explanatoryMultivariate4 <- c("yas", "gender", "cap", "MetastaticLN", "SurgicalMargin", "LVI", "PNI", "SSTR")
dependentMultivariate4 <-  "Surv(time, Outcome)"

masco_pannet %>%
  finalfit::finalfit(dependentMultivariate4, explanatoryMultivariate4) -> tMultivariate4

knitr::kable(tMultivariate4, row.names=FALSE, align=c("l", "l", "r", "r", "r", "r"))
```


---

\pagebreak



# Other Tables


library(arsenal) library(tidyverse) data(mockstudy) mockstudy %>% tableby(arm ~ chisq(sex, digits.pct=1) + anova(age, digits=4) + anova(fu.time, digits = 1), data=.) %>% summary() %>% knitr::kable()


library(intubate) library(arsenal) library(tidyverse) data(mockstudy) mockstudy %>% ntbt(tableby, arm ~ chisq(sex, digits.pct=1) + anova(age, digits=4) + anova(fu.time, digits = 1)) %>% summary() %>% knitr::kable()


---

\pagebreak


# Save Final Data

saved data after analysis to `MASCO-PanNET-Data-After-Analysis.xlsx`.

```{r}
saveRDS(masco_pannet, "MASCO-PanNET-Data-After-Analysis.rds")

writexl::write_xlsx(masco_pannet, "MASCO-PanNET-Data-After-Analysis.xlsx")

file.info("MASCO-PanNET-Data-After-Analysis.xlsx")$ctime

```

---

\pagebreak


# Libraries Used

```{r}
citation()
```

```
citation("tidyverse")
citation("foreign")
citation("tidylog")
citation("janitor")
citation("jmv")
citation("tangram")
citation("finalfit")
citation("summarytools")
citation("ggstatplot")
citation("readxl")
```


```{r eval=FALSE, include=FALSE}
citation("tidyverse")
citation("foreign")
citation("tidylog")
citation("janitor")
citation("jmv")
citation("tangram")
citation("finalfit")
citation("summarytools")
citation("ggstatplot")
citation("readxl")
```


---


```{r, results='asis'}
report::cite_packages(session = sessionInfo())
```


---



```{r}
sessionInfo()
```

---

\pagebreak



# Notes  

Completed on `r Sys.time()`.  

Serdar Balci, MD, Pathologist  
drserdarbalci@gmail.com  
https://rpubs.com/sbalci/CV   


---






